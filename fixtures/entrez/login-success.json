{
  "name": "login-success",
  "status_code": 200,
  "headers": [
    "HTTP/2 200 \r",
    "Date: Mon, 01 Jan 2024 00:00:00 GMT\r",
    "content-type: text/html;charset=UTF-8\r",
    "cache-control: no-cache, no-store, max-age=0, must-revalidate\r",
    "content-language: en-US\r",
    "expires: 0\r",
    "pragma: no-cache\r",
    "set-cookie: SESSION=SANITIZED_SESSION; Path=/; Secure; HttpOnly; SameSite=Lax\r",
    "strict-transport-security: max-age=31536000; includeSubDomains\r",
    "x-content-type-options: nosniff\r",
    "x-frame-options: DENY\r",
    "x-xss-protection: 0\r",
    "\r"
  ],
  "body": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <script src=\"https://app.secureprivacy.ai/script/SANITIZED_SCRIPT_ID.js\"></script>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Enphase Authentication | Select Gateway</title>\n    <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap\" />\n    <link rel=\"stylesheet\" href=\"/style.css\" />\n    <link rel=\"stylesheet\" href=\"https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css\">\n    <script src=\"https://code.jquery.com/jquery-1.12.4.js\"></script>\n    <script src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.js\"></script>\n</head>\n<body>\n<div id=\"root\">\n    <!-- Page Header -->\n    <header class=\"container-fluid header\">\n        <a href=\"#\" class=\"header__logo\">\n            <img src=\"/ENLMLogo.png\" title=\"Enlighten Manager\" alt=\"Enlighten Manager\" />\n        </a>\n    </header>\n\n    <!-- Page Content -->\n    <article class=\"container-fluid content\">\n        <!-- Create access token -->\n        <section class=\"container\" disa>\n            <h1 class=\"content__title\">Authentication</h1>\n            <div class=\"content__card\" >\n                <h2 >Create access token</h2>\n                <form class=\"content__form\" action=\"/entrez_tokens\" method=\"post\" ><input type=\"hidden\" name=\"_csrf\" value=\"SANITIZED_CSRF_TOKEN\"/>\n\n\n\n                    <div id=\"owner_box\">\n                        <!-- Show radio buttons only when both options are available -->\n                        \n                        \n                        <!-- Show single option when uncommissioned is disabled -->\n                        <div>\n                            <p class=\"single-option-text\">Generating token for commissioned gateway</p>\n                            <input type=\"hidden\" id=\"commissioned-hidden\" name=\"uncommissioned\" value=\"false\">\n                        </div>\n                    </div>\n\n                    <br>\n\n\n                    <fieldset>\n                        <div class=\"content__form-group\" hidden>\n                            <label for=\"selectSystem\">Select System <span>*</span></label>\n                            <input id=\"selectSystem\" type=\"text\" name=\"Site\" class=\"system\">\n                        </div>\n                        <br>\n                        <div class=\"content__form-group\" hidden>\n                            <label for=\"serialNum\">Select Gateway <span>*</span></label>\n                            <select onchange=\"changeFunc()\" name=\"serialNum\" id=\"serialNum\" onclick=\"myFunction()\">\n                                <option value=\"0\" disabled=\"disabled\">--Select Gateway--</option>\n                            </select>\n                        </div>\n                        <br>\n                        <button id=\"submit\" type=\"submit\">Create access token</button>\n                    </fieldset>\n                </form>\n                <form class=\"content__form\" action=\"/logout\" method=\"post\"><input type=\"hidden\" name=\"_csrf\" value=\"SANITIZED_CSRF_TOKEN\"/>\n                    <button type=\"submit\">Sign Out</button>\n                </form>\n            </div>\n        </section>\n    </article>\n</div>\n<script>\n    var sitesDto = [];\n\nfunction updateForm(isHidden){\n    var header = document.getElementsByClassName(\"content__form-header\");\n    var content = document.getElementsByClassName(\"content__form-group\");\n    for( ele of header ){ ele.hidden = isHidden; }\n    for( ele of content ){ ele.hidden = isHidden; }\n}\n\nfunction process(){\n    var button = document.getElementById(\"un-commissioned\");\n    var commissionedLabel = document.getElementById(\"commissioned-label\");\n    var uncommissionedLabel = document.getElementById(\"uncommissioned-label\");\n    \n    if (!button) {\n        // Un-commissioned option is disabled, only allow commissioned tokens\n        updateForm(false);\n        if (commissionedLabel) commissionedLabel.style.fontWeight = '450';\n        changeFunc();\n        return;\n    }\n    \n    if( button.checked == false ){\n        updateForm(false);\n        button.value = false;\n        commissionedLabel.style.fontWeight = '450';\n        if (uncommissionedLabel) uncommissionedLabel.style.fontWeight = '400';\n        changeFunc();\n    }else{\n        commissionedLabel.style.fontWeight = '400';\n        if (uncommissionedLabel) uncommissionedLabel.style.fontWeight = '450';\n        button.value = true;\n        document.getElementById(\"submit\").disabled = false;\n        document.getElementById(\"submit\").style.backgroundColor = '#E47939';\n        updateForm(true);\n    }\n}\n\n$( function() {\n    $(document).ready(function() {\n        var role = \"installer\";\n        var uncommissionedEnabled = false;\n        if (role == \"owner\"){\n            updateForm(false);\n            document.getElementById(\"submit\").disabled = true;\n            document.getElementById(\"submit\").style.backgroundColor = '#C8C9CB';\n        }\n        else {\n            if (!uncommissionedEnabled) {\n                // When uncommissioned is disabled, set up form for commissioned tokens but keep validation\n                updateForm(false);\n                // Don't auto-enable submit button - let changeFunc() handle validation\n                document.getElementById(\"submit\").disabled = true;\n                document.getElementById(\"submit\").style.backgroundColor = '#C8C9CB';\n            } else {\n                updateForm(true);\n                if (document.getElementById(\"un-commissioned\")) {\n                    document.getElementById(\"un-commissioned\").value = true;\n                }\n            }\n        }\n    });\n\n    $( \"#selectSystem\" ).autocomplete({\n      source: function( request, response ) {\n        $.ajax({\n            dataType: \"json\",\n            type : 'Get',\n            url: '/site/'+$(\"#selectSystem\").val(),\n            success: function(data) {\n                sitesDto = $.extend( true, {}, data );\n                response( $.map( data, function(item) {\n                    return item.name + \" - \" + item.id;\n                }));\n            },\n            error: function(data) {\n                $('input.suggest-user').removeClass('ui-autocomplete-loading');\n            }\n        });\n        },\n      minLength: 3,\n      close: function( event, ui ) {myFunction();changeFunc();}\n    });\n } );\n\n\nfunction myFunction(){\n    var site_identifier = document.getElementById(\"selectSystem\").value;\n    var select = document.getElementById(\"serialNum\");\n    var sites = new Map(Object.entries(sitesDto));\n    for ( let [key,site] of sites) {\n        if(site_identifier === site.name + \" - \" + site.id){\n            document.getElementById(\"selectSystem\").value = site.name;\n            var optionsCount  = select.getElementsByTagName('option').length -1;\n            if(site.serial_numbers.length !== optionsCount || site.serial_numbers[site.serial_numbers.length-1] !== select.getElementsByTagName('option')[optionsCount].value){\n                while (select.hasChildNodes()) {\n                    select.removeChild(select.firstChild);\n                }\n\n                var option1 = document.createElement(\"option\");\n                option1.disabled = \"disabled\";\n                option1.text = \"--Select Gateway--\";\n                option1.value=0;\n                select.appendChild(option1);\n\n                for( const envoy of site.serial_numbers){\n                    var option = document.createElement(\"option\");\n                    option.value = envoy;\n                    option.text = envoy;\n                    select.appendChild(option);\n                }\n                select.value = 0;\n            }\n            break;\n         }\n    }\n}\n\n    function changeFunc(){\n        var gatewaySelection = document.getElementById(\"serialNum\");\n        var submitButton = document.getElementById(\"submit\");\n        if (gatewaySelection.value === \"0\" || gatewaySelection.value === \"\"){\n            submitButton.disabled = true;\n            submitButton.style.backgroundColor = '#C8C9CB';\n        }else{\n            submitButton.disabled = false;\n            submitButton.style.backgroundColor = '#E47939';\n        }\n    }\n</script>\n<footer class=\"footer\" style=\"display: flex; align-items: center; gap: 10px; padding: 10px 20px;\">\n    <!-- SecurePrivacy logo appears automatically, so add spacing -->\n    <span style=\"margin-left: 40px;\"></span>\n\n    <div class=\"footer__content\" style=\"display: flex; flex-wrap: wrap; align-items: center; gap: 10px; font-size: 14px;\">\n        <span style=\"color: #ee610c;\" >©2008–2025 Enphase Energy Inc. All rights reserved.</span>\n        <a href=\"https://enphase.com/en-us/legal/privacy-policy\" style=\"color: #ee610c;\" target=\"_blank\"  rel=\"noopener noreferrer\">Privacy</a>\n        <span style=\"color: #ee610c;\">|</span>\n        <a href=\"https://enphase.com/en-us/legal/terms-of-service\" style=\"color: #ee610c;\"  target=\"_blank\"  rel=\"noopener noreferrer\">Terms</a>\n        <span style=\"color: #ee610c;\">|</span>\n        <a href=\"#\" role=\"button\" style=\"color: #ee610c;\"\n           onclick=\"event.preventDefault(); if (window.parent?.sp?.openTrustWidget) { window.parent.sp.openTrustWidget(); }\">\n            Settings / Do not sell or share my personal information\n        </a>\n    </div>\n</footer>\n</body>\n</html>\n"
}
